aiueo
% sync test
\documentclass{article}
\usepackage{graphicx} 
\usepackage{float}

\title{交通事故予測の試作}

\author{指導教員 笠松大佑\\
2258238 松田藍}

\begin{document}
\maketitle
\newpage
\renewcommand{\contentsname}{目次}
\tableofcontents



\newpage
\newpage
\thispagestyle{plain} 
\begin{center}
\vspace*{5cm}
{\Huge \bfseries 第一章\par}
\vspace{1cm}
{\Huge \bfseries はじめに\par}
\vfill
\end{center}
\newpage



\section{はじめに}
\subsection{高速道路の発展}
近年,都市の発展や物流需要の高まりにより,高速道路や有料道路の整備と利用は全国的に拡大している.令和２年度から令和５年度のe-NEXCOの東日本の統計によると,高速道路における平均一日あたりの交通量は約275万台に達し,そのうち首都高速道路が約100万台と約4割を占めている.こうした交通インフラの発展は,都市間の移動効率や経済活動の円滑化に大きく貢献している.

\subsection{高速道路における事故実態}
警察庁の統計によると,2022年の国内における交通事故件数は約30万件,死傷者数は約36万人を超えている.中でも高速道路で発生する事故は,発生頻度は一般道路に比べ低いが,重大事故に繋がる割合が高いことが特徴である.実際に令和４年中の高速道路における死亡事故率は約2.4％であり,一般道路の0.8％と比べ約３倍となっている.このことから,高速道路は一般道路よりも多くの事故を起こす可能性が高いため,交通予測を行うことで,道路の危険状態を把握し,ドライバーや事故リスクが高い場所に対しての講じることが可能である.


\subsection{研究の目的}
本研究では,交通事故予測の精度向上を目的として,地図上の情報に着目する.具体的には,トンネル・高速道路の入り口出口・橋を新たにノード情報に追加し,深層学習モデルへ入力することで,従来よりも高精度な予測を実現することを目指す.

\newpage
\thispagestyle{plain} 
\begin{center}
\vspace*{5cm}
{\Huge \bfseries 第二章\par}
\vspace{1cm}
{\Huge \bfseries 関連研究\par}
\vfill
\end{center}
\newpage


\section{関連研究}
\subsection{交通事故予測と深層学習}
交通事故予測は,交通安全対策の根幹の重要なタスクである.従来の統計モデルでは,交通量や気象などの複雑な要因の関係性や増大する交通データのパターンを捉えきれない課題があったが,近年では,この課題解決のツールとして深層学習が注目されている.特に,ＣＮＮによる空間的特徴の抽出,ＲＮＮによる時系列データの学習,ＧＮＮによる道路ネットワーク構造の解析など,様々なモデルが適用されている.深層学習は,データから高精度な予測を行うことで事故のホットスポット特定や発生件数,時間予測を可能にし,交通安全を向上する技術であることから非常に重要なタスクである.

\newpage

\subsection{時空間グラフ表現学習による交通事故予測}
交通事故は,その発生が時間的・空間的な要因に深く関連する複雑な事象である.ZHI LUIらの研究では,マルチタスクの時空間グラフ表現学習による交通事故予測(TAP)が提案されていた.彼らは,従来のCNN,LSTM,GNNなどの単体モデルでは時間空間的な複雑性を十分にモデル化できないとし,交通データを用いた時間空間的ダイナミクスを捉える交通事故予測手法が求められると挙げた.そのため,将来の時間スライスの交通事故プロファイリングを生成する目的の4層からなる時空間グラフ表現学習フレームワークを提案している.その中で,交通データの動的な時空間相関をモデル化するための新しい時空間変分グラフエンコーダ(ST-VGAE)を作成した.このST-VGAEに正規化フローの導入や変分推論の修正を加えることで構築された交通事故フレームワーク(TAP)は,既存の複数のモデルと比較され,Recall(再現率), Precision(適合率), F1-Score(F1スコア) ,Accuracy(正解率), AUC(Area Under the Curve)ともに他モデルよりも高いスコアが見られ,その有効性が示されている.

しかしながら,使用される特徴量は主に交通量,速度,占有率,天候情報などに限定されており,事故が多発する地点に関する情報が十分に考慮されていない点が課題として挙げられる.これにより,特定地点における事故発生傾向がモデルに反映されにくく,実環境での事故リスクの差異を捉えるには限界があると考えられる. 


\newpage

\subsection{交通事故多発地点の導入}
小森谷は, ZHI LUIらの提案したTAPモデルの構造を基盤に,事故多発地点に関する指標（NormAccidentRate）を新たに特徴量として導入することで,交通事故予測精度のさらなる向上を試みた.このアプローチでは,過去の事故履歴と交通量データに基づいて,各ノード（センサー）の事故発生率を算出し,これを正規化してモデルの入力に組み込む.この手法では,TAPと同様にST-VGAEを用いた時空間グラフ表現学習を採用しつつ,POIデータ的な意味合いを持つ「事故発生傾向」を直接反映した特徴量を追加することで,モデルが学習可能な情報の幅を広げた点が特徴である. この事故多発地点データ(NormAccidentRate)を追加した手法の結果は,ZHI LUIらのTAPモデルと比較され,Precision(適合率),Recall(再現率), F1-Score(F1スコア) ともにTAPモデルよりも高いスコアが見られ,その有効性が示されている.

図４：ZHI LUIらのTAPモデルと事故多発地点データ追加モデルのスコア比較グラフ
（小森谷さんの図１２を入れる）

しかしながら ,事故多発地点データの作成には事故数や交通量の精緻な集計と前処理が必要であり,データ品質や時間的スパンの設定によって指標の有効性が左右される点が課題として挙げられる.また,事故が少ない地点では学習データが不十分になる可能性があり,そうした場合のモデルの汎化性能に対しても検討が必要な点である.

これまでの研究では,交通事故予測モデルにおいて一定の成果が得られているものの,入力される特徴量が限定的であるという課題が残されている.具体的には,高速道路のジャンクションやトンネル等の交通道路の発生しやすい地点や時間帯の情報が十分に活用されておらず,モデルが事故リスクの高い条件を正確に学習することが難しい状況にあった.


\newpage

\subsection{技術}
\subsubsection{グラフニューラルネットワーク(GNN)}
グラフニューラルネットワークとは、ディープラーニングの一種であり、グラフ構造データに特化したモデルである。各ノードが自身の特徴に加え、隣接ノードの特徴とエッジの情報も集約し、ノードの表現の更新を繰り返すことで、ノードがグラフ全体の構造的な情報を含んだ表現ができる。これは行列で表され、ノード間の関係性やグラフ全体の構造が重要な分析に適している。
交通予測においては、GNNは道路ネットワークをグラフとして用いている。交差点や道路区間をノード、道路をエッジとして交通量などを扱う。複雑な交通流道や相互作用を捉え、渋滞予測や最適なルート案内の精度向上等に貢献している。

\newpage

\subsubsection{オートエンコーダ(AE)・変分オートエンコーダ(VAE)}

オートエンコーダ(AE)とは、教師なし学習モデルの一種であり、入力データを圧縮・符号化(エンコード)し、その後元データに復元・再構成(デコード)する。AEは主にエンコーダとデコーダから構成されており、エンコーダでは入力データxを低次元の潜在表現ｚに変換する。また、デコーダではその潜在表現ｚから元のデータｘに近いデータｘ‘を再構築する。学習は入力データｘと再構築されたｘ’の間の再構成誤差を最小化することで行われる。このプロセスから、AEはデータの次元削減を行いながら、特徴を抽出しているが、潜在空間が不連続になる傾向があり、潜在空間からの新規データ生成は困難である。

変分オートエンコーダ(VAE)は、AEを確率的に拡張したモデルである。VAEはオートエンコーダの持つデータ圧縮と特徴学習の能力に加え、連続的で潜在空間からの新規データ生成をする。VAEもエンコーダとデコーダで構成されるが、そのエンコーダは入力データ x を単一の潜在ベクトルにマッピングするのではなく、潜在空間における確率分布（通常は多次元正規分布の平均と分散）として表現する。デコーダはこのサンプリングされた潜在変数を受け取り、元のデータの再構成を行う。学習は、再構成誤差の最小化に加え、エンコーダが推定する潜在分布を標準正規分布に近づけるKLダイバージェンスの最小化によって行われる。このKLダイバージェンスの項が、VAEの潜在空間を連続的かつ滑らかなものにしている。VAEの用途としては、データの生成や次元削減などが挙げられる。

\newpage

\subsubsection{畳み込みニューラルネットワーク(CNN)・グラフ畳み込みネットワーク(GCN)}


畳み込みニューラルネットワーク(CNN)は主に画像データ分析に特化したディープラーニングモデルである。CNNの核である畳み込み層では、小さな行列(カーネル)が画像上をスライドしながら、ピクセル値と乗加算を行うことで特徴マップを生成、エッジや形状などの局所的な特徴を抽出する。この畳み込み層を複数重ねることで、階層的に学習し、その後プーリング層にて、特徴マップの次元を削減する流れである。

グラフ畳み込みネットワーク(GCN)は、CNNの概念をグラフ構造データに適用したGNNの一種である。CNNが画像上の隣接ピクセルから特徴抽出するのと同様に、GCNはグラフのノードとその隣接ノードからの情報を集約することでノードの新しい特徴表現を学習する。GCNにおける「畳み込み」操作は、グラフの各ノードが自身の特徴量と、隣接ノードの特徴量を集約することで行われる。これは、グラフの隣接行列とノードの特徴行列を用いた行列演算によって数学的に表現される。複数のGCN層を積み重ねることで、各ノードはより広範囲の隣接ノードからの情報を取り込んだ特徴表現を学習することが可能となる。
GCNは、グラフの構造情報を直接考慮しながら、ノードレベル やグラフレベル のタスクに対して強力な特徴表現を学習できるため、ソーシャルネットワーク分析、分子構造解析、交通予測など、多岐にわたるグラフ分析タスクに応用されている
\newpage

\subsubsection{変分グラフオートエンコーダ(VGAE)}
変分グラフオートエンコーダ（VGAE） は,変分オートエンコーダ（VAE） のエンコーダ部分にグラフ畳み込みネットワーク（GCNなど） を適用することで,グラフ構造データの潜在空間での表現を学習するモデルである.
VGAEと従来のVAEとの主な違いは,扱えるデータの種類と入出力である.VAEが画像やテキストといったユークリッド空間のデータをエンコーダに入力し,デコーダで元のデータを再構成するのに対し,VGAEはエンコーダでグラフ情報,すなわちノード情報と隣接行列を直接受け取ること,デコーダが出力するものが,元のグラフ構造を再構築した隣接行列となりことである.


\newpage

\subsubsection{ST-VGAE}
ST-VGAEは,交通データに存在する時空間相関をモデル化するために開発された,変分グラフオートエンコーダ (VGAE) の一種であり,このモデルの主な目的は,交通データを用いて交通事故のリスクと重大度を予測することある.
ST-VGAEは,エンコーダ,デコーダ,正規化フロー,および損失関数という主要な構成要素から成り立つ.エンコーダは,交通データの特徴を学習し,グラフ構造の潜在表現を獲得する役割を担っており,内部には,複雑な時空間情報を効率的に捉えるため,時空間畳み込みブロックが用いられている.このブロックは,GCNとCNNを組み合わせている.さらに,過学習を抑制するため,各時空間畳み込みブロックには残差ネットワークが追加されている.
デコーダは,エンコーダによって得られた潜在表現の内積を利用して,元のグラフ構造を再構築した隣接行列を出力する.また,正規化フローは,単純な潜在分布をより複雑な現実のデータ分布に変換することで,モデルの表現力を高める役割である.モデルの学習は,再構成されたデータと元のデータの差を測る再構成損失と,学習された潜在分布が標準正規分布に近づくように促すKLダイバージェンスという二つの損失関数を最小化することで進行する.


\newpage

\section{問題定式化}
ZHI LUIの研究では,ST-VGAEに基づくマルチタスク交通事故予測フレームワーク (TAP) が提案された.このモデルは,交通データ,事故データ,天候データを統合し,時空間相関をモデル化することで高い予測精度を示し,都市計画や交通管理への実用性が期待される.しかし,従来のモデルは地点ごとの事故要因を十分に捉えきれていなかったため,小森谷の研究では,NormAccidentRateという事故多発地点指標を導入した.TAPモデルと比較してPrecision,Recall,F1-scoreのいずれも高いスコアを示し有効性を確認したが,データ品質や汎化性能に課題を残した.これらの先行研究では,交通量や気象情報に加え,過去の事故発生率が活用されてきた一方で,道路の物理的な特徴や構造といった地図上の詳細な地点情報が十分に考慮されていないという根本的な課題が残されている.
そこで本研究では,この課題に対処するため,トンネル,高速道路の出入口,橋などの構造的な特徴を新たなノード情報としてPOIデータ的な意味合いで追加し,全体の交通事故予測精度を向上させる.

\newpage
\newpage
\newpage
\thispagestyle{plain} 
\begin{center}
\vspace*{5cm}
{\Huge \bfseries 第三章\par}
\vspace{1cm}
{\Huge \bfseries 提案手法\par}
\vfill
\end{center}
\newpage

\section{提案手法}
本研究では,先行研究で提案された,交通データの時空間相関を捉えるディープラーニングモデルであるTAPを用いて,入力する特徴量にPOIデータの追加をし、交通事故予測の精度向上を図る.具体的には,トンネル・高速道路の入り口出口・橋を新たにノード情報に追加し,深層学習モデルへ入力する.


\section{アーキテクチャ}

\section{参考文献}
%e-NEXCO東日本　高速道路データ
%警察庁　file:///C:/Users/%E3%81%82%E3%81%84/Downloads/%E6%AD%BB%E4%BA%A1%E4%BA%8B%E6%95%852022.pdf
%内閣府　交通安全白書
\end{document}
